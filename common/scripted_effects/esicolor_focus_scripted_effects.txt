add_1_dockyard_in_random_state = {
	random_controlled_state = {
		limit = {
			is_coastal = yes
			free_building_slots = {
				building = dockyard
				size > 0
				include_locked = yes
			}
			if = {
				limit = {
					controller = {
						any_owned_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 0
								include_locked = yes
							}
							is_controlled_by = ROOT
							is_core_of = ROOT
						}
					}
				}
				is_owned_by = ROOT
				is_core_of = ROOT ## Prioritise owned cores.
			}
			else_if = {
				limit = {
					controller = {
						any_controlled_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 0
								include_locked = yes
							}
							is_core_of = ROOT
						}
					}
				}
				is_core_of = ROOT ## Then controlled cores.
			}
			else_if = {
				limit = {
					controller = {
						any_owned_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 0
								include_locked = yes
							}
							is_controlled_by = ROOT
						}
					}
				}
				is_owned_by = ROOT ## Then owned non-cores, if this fails too it goes to a random state.
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = dockyard
			level = 1
			instant_build = yes
		}
	}
}

add_3_dockyard_in_random_state = {
	random_controlled_state = {
		limit = {
			is_coastal = yes
			free_building_slots = {
				building = dockyard
				size > 2
				include_locked = yes
			}
			if = {
				limit = {
					controller = {
						any_owned_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 2
								include_locked = yes
							}
							is_controlled_by = ROOT
							is_core_of = ROOT
						}
					}
				}
				is_owned_by = ROOT
				is_core_of = ROOT ## Prioritise owned cores.
			}
			else_if = {
				limit = {
					controller = {
						any_controlled_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 2
								include_locked = yes
							}
							is_core_of = ROOT
						}
					}
				}
				is_core_of = ROOT ## Then controlled cores.
			}
			else_if = {
				limit = {
					controller = {
						any_owned_state = {
							is_coastal = yes
							free_building_slots = {
								building = dockyard
								size > 2
								include_locked = yes
							}
							is_controlled_by = ROOT
						}
					}
				}
				is_owned_by = ROOT ## Then owned non-cores, if this fails too it goes to a random state.
			}
		}
		add_extra_state_shared_building_slots = 3
		add_building_construction = {
			type = dockyard
			level = 3
			instant_build = yes
		}
	}
}

add_1_industrial_complex_in_random_state = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = industrial_complex
				size > 0
				include_locked = yes
			}
			if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
							is_core_of = ROOT
						}
					}
				}
				is_in_home_area = yes
				is_core_of = ROOT ## Prioritise cores in home area.
			}
			else_if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_core_of = ROOT
						}
					}
				}
				is_core_of = ROOT ## Then cores not in home area.
			}
			else_if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = industrial_complex
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
				is_in_home_area = yes ## Then non-cores in home area, if this fails too it goes to a random state.
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}

add_1_arms_factory_in_random_state = {
	random_owned_controlled_state = {
		limit = {
			free_building_slots = {
				building = arms_factory
				size > 0
				include_locked = yes
			}
			if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
							is_core_of = ROOT
						}
					}
				}
				is_in_home_area = yes
				is_core_of = ROOT ## Prioritise cores in home area.
			}
			else_if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_core_of = ROOT
						}
					}
				}
				is_core_of = ROOT ## Then cores not in home area.
			}
			else_if = {
				limit = {
					owner = {
						any_owned_state = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
							is_in_home_area = yes
						}
					}
				}
				is_in_home_area = yes ## Then non-cores in home area, if this fails too it goes to a random state.
			}
		}
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}

war_goal_effect_on_random_neighbour = {
	if = {
		limit = {
			any_neighbor_country = {
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				any_owned_state = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}
			}
		}

		random_neighbor_country = {
			limit = {
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}
			}

			random_owned_state = {
				limit = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}

				claim_action_effect = yes
			}
		}
	}
	else_if = {
		limit = {
			any_country = {
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}
		}

		random_country = {
			limit = {
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}

			random_owned_state = {
				limit = {
					is_neighboring_ownership_special_case_state = yes
				}

				claim_action_effect = yes
			}
		}
	}
}
war_goal_effect_on_random_neighbour_communist_or_fascist = {
	if = {
		limit = {
			any_neighbor_country = {
				OR = {
					has_government = fascism
					has_government = communism
				}
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				any_owned_state = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}
			}
		}

		random_neighbor_country = {
			limit = {
				OR = {
					has_government = fascism
					has_government = communism
				}
				NOT = {
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}
			}

			random_owned_state = {
				limit = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}

				claim_action_effect = yes
			}
		}
	}
	else_if = {
		limit = {
			any_country = {
				NOT = {
					OR = {
						has_government = fascism
						has_government = communism
					}
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}
		}

		random_country = {
			limit = {
				NOT = {
					OR = {
						has_government = fascism
						has_government = communism
					}
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}

			random_owned_state = {
				limit = {
					is_neighboring_ownership_special_case_state = yes
				}

				claim_action_effect = yes
			}
		}
	}
}
war_goal_effect_on_random_neighbour_non_communist = {
	if = {
		limit = {
			any_neighbor_country = {
				NOT = {
					has_government = communism
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				any_owned_state = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}
			}
		}

		random_neighbor_country = {
			limit = {
				NOT = {
					has_government = communism
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}
			}

			random_owned_state = {
				limit = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}

				claim_action_effect = yes
			}
		}
	}
	else_if = {
		limit = {
			any_country = {
				NOT = {
					has_government = communism
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}
		}

		random_country = {
			limit = {
				NOT = {
					has_government = communism
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}

			random_owned_state = {
				limit = {
					is_neighboring_ownership_special_case_state = yes
				}

				claim_action_effect = yes
			}
		}
	}
}
war_goal_effect_on_random_neighbour_different_ideology = {
	if = {
		limit = {
			any_neighbor_country = {
				NOT = {
					has_government = ROOT
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				any_owned_state = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}
			}
		}

		random_neighbor_country = {
			limit = {
				NOT = {
					has_government = ROOT
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}
			}

			random_owned_state = {
				limit = {
					OR = {
						has_global_flag = claiming_give_war_goals
						has_global_flag = claiming_declare_war

						NOT = { is_claimed_by = ROOT }
					}

					any_neighbor_state = {
						is_owned_by = ROOT
					}
				}

				claim_action_effect = yes
			}
		}
	}
	else_if = {
		limit = {
			any_country = {
				NOT = {
					has_government = ROOT
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}
		}

		random_country = {
			limit = {
				NOT = {
					has_government = ROOT
					original_tag = OOO
					is_in_faction_with = ROOT
					is_subject_of = ROOT
					is_subject_of = ROOT.overlord
					has_subject = ROOT
					has_non_aggression_pact_with = ROOT
					ROOT = { has_wargoal_against = PREV }
				}

				OR = {
					has_global_flag = claiming_give_war_goals
					has_global_flag = claiming_declare_war

					NOT = { any_owned_state = { is_claimed_by = ROOT } }
				}

				is_neighboring_ownership_special_case_country = yes
			}

			random_owned_state = {
				limit = {
					is_neighboring_ownership_special_case_state = yes
				}

				claim_action_effect = yes
			}
		}
	}
}

ask_random_neighbour_for_integration = {
	if = {
		limit = {
			any_neighbor_country = {
				has_government = ROOT
				NOT = {
					original_tag = OOO
					is_in_faction = yes
					is_subject = yes
					num_subjects > 0
					has_war_with = ROOT
				}
			}
		}

		random_neighbor_country = {
			limit = {
				has_government = ROOT
				NOT = {
					original_tag = OOO
					is_in_faction = yes
					is_subject = yes
					num_subjects > 0
					has_war_with = ROOT
				}
			}

			country_event = esicolor_china.1
		}
	}
	else_if = {
		limit = {
			any_country = {
				has_government = ROOT
				NOT = {
					original_tag = OOO
					is_in_faction = yes
					is_subject = yes
					num_subjects > 0
					has_war_with = ROOT
				}

				is_neighboring_ownership_special_case_country = yes
			}
		}

		random_country = {
			limit = {
				has_government = ROOT
				NOT = {
					original_tag = OOO
					is_in_faction = yes
					is_subject = yes
					num_subjects > 0
					has_war_with = ROOT
				}

				is_neighboring_ownership_special_case_country = yes
			}

			country_event = esicolor_china.1
		}
	}
}

setup_utilize_our_strengths_effects = {
	clr_country_flag = gets_HOA_our_strength_fighting_idea
	clr_country_flag = gets_HOA_our_strength_production_idea
	clr_country_flag = gets_HOA_our_strength_research_idea

	if = {
		limit = {
			OR = {
				original_tag = BAE
				original_tag = YOB

				original_tag = BAZ

				original_tag = BEF
			}
		}
		set_country_flag = gets_HOA_our_strength_fighting_idea
	}
	else_if = {
		limit = {
			OR = {
				original_tag = ZFI
				original_tag = CFM # BEL

				original_tag = BEB

				original_tag = BEY
				original_tag = BAO
			}
		}
		set_country_flag = gets_HOA_our_strength_production_idea
	}
	else_if = {
		limit = {
			OR = {
				original_tag = BES

				original_tag = BAI
			}
		}
		set_country_flag = gets_HOA_our_strength_research_idea
	}
	else = {
		random_list = {
			1 = { set_country_flag = gets_HOA_our_strength_fighting_idea }
			1 = { set_country_flag = gets_HOA_our_strength_production_idea }
			1 = { set_country_flag = gets_HOA_our_strength_research_idea }
		}
	}
}

make_current_leader_democratic = {
	random_character = {
		limit = {
			is_country_leader = yes
			NOT = { has_ideology_group = democratic }
		}

		add_country_leader_role = {
			country_leader = {
				expire = "1965.1.1"
				ideology = socialism
			}
			promote_leader = yes
		}
	}
}
make_current_leader_communist = {
	random_character = {
		limit = {
			is_country_leader = yes
			NOT = { has_ideology_group = communism }
		}

		add_country_leader_role = {
			country_leader = {
				expire = "1965.1.1"
				ideology = anti_revisionism
			}
			promote_leader = yes
		}
	}
}
make_current_leader_fascist = {
	random_character = {
		limit = {
			is_country_leader = yes
			NOT = { has_ideology_group = fascism }
		}

		add_country_leader_role = {
			country_leader = {
				expire = "1965.1.1"
				ideology = rexism
			}
			promote_leader = yes
		}
	}
}
make_current_leader_non_aligned = {
	random_character = {
		limit = {
			is_country_leader = yes
			NOT = { has_ideology_group = neutrality }
		}

		add_country_leader_role = {
			country_leader = {
				expire = "1965.1.1"
				ideology = despotism
			}
			promote_leader = yes
		}
	}
}
